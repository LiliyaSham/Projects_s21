# Use Case: Онлайн-запись на услугу в барбершоп

## Уникальный идентификатор
UC-002-CUS

## Цель (назначение) UC
Дать клиентам возможность записываться на услуги барбершопа онлайн, увеличив количество клиентов за счёт удобства онлайн-записи.

## Основное действующее лицо (роль)
**Клиент / Зарегистрированный или незарегистрированный посетитель сайта**

### Интерес (потребность)
Записаться в барбершоп на услугу к выбранному мастеру в удобное время без необходимости звонить или приходить лично.

## Другие заинтересованные стороны и их интересы

- **Менеджер**  
  *Интерес:* Сокращение времени на ручную запись клиентов, снижение вероятности ошибок, рост числа клиентов.

- **Мастер**  
  *Интерес:* Рост числа клиентов за счёт удобства онлайн-записи.

## Предусловия
- Клиент имеет доступ к системе через интерфейс (может быть как зарегистрирован, так и нет).
- В системе содержится актуальное расписание мастеров.

## Триггер
Клиент решает записаться на услугу через систему онлайн-записи.

## Постусловия

### Минимальные гарантии
Система сохраняет текущее состояние данных до начала выполнения UC и историю действий клиента.

### Гарантии успеха
Клиент успешно забронировал слот, и система отправила ему подтверждение записи.

## Основной сценарий

1. Клиент открывает интерфейс записи на услугу и выбирает тип услуги (парикмахерские или косметологические).  
2. Система отображает список доступных услуг и их стоимость.  
3. Клиент выбирает услугу.  
4. Система показывает список мастеров, предоставляющих выбранную услугу.  
5. Клиент выбирает мастера из списка.  
6. Система отображает свободные слоты для выбранного мастера.  
7. Клиент выбирает свободный слот.  
8. Система запрашивает подтверждение записи на указанную услугу к указанному мастеру на указанное время.  
9. Клиент подтверждает бронирование.  
10. Система выводит сообщение о том, что клиент успешно записался на услугу к мастеру в выбранное время.  
11. Система создает запись и изменяет статус слота на «занят».  
12. Система отправляет подтверждение записи клиенту по выбранному им каналу связи.

## Альтернативные сценарии

### 7a. Клиенту не подходят предложенные слоты
1. Клиент нажимает «назад» на шаге 7 основного сценария.  
2. Система возвращает клиента к предыдущему экрану.  
→ Возврат на шаг 5 основного сценария.

### 8a. Запись незарегистрированного посетителя сайта
1. Система запрашивает у незарегистрированного посетителя контактные данные (имя, телефон), предпочтительный канал связи (WhatsApp, SMS, Telegram) и согласие на обработку персональных данных — до шага 8 основного сценария.  
2. Клиент указывает данные и дает согласие.  
→ Возврат на шаг 8 основного сценария.

### 6a. У выбранного мастера нет свободных слотов
1. Система информирует клиента об отсутствии свободных слотов и предлагает выбрать другого мастера.  
2. Клиент выбирает другого мастера.  
→ Возврат на шаг 6 основного сценария или шаг 6a альтернативного сценария.

### 9a. Неподтверждение бронирования
1. Клиент нажимает кнопку «Отменить» на шаге 9.  
2. Система не создает запись и не изменяет статус слота.  
3. Система возвращает клиента к предыдущему экрану.

## Связанные Use Cases

### UC-002A-CUS: Подтверждение записи  
**Тип связи:** Include (включение)

**Описание:** После успешного бронирования система показывает клиенту подтверждение записи и отправляет его по выбранному каналу связи.

1. Система показывает клиенту уведомление о подтверждении записи с указанием услуги, мастера и времени.  
2. Система формирует сообщение по заранее загруженному шаблону.  
3. Система отправляет сообщение через выбранный канал связи (Telegram, WhatsApp, SMS).  
4. Система сохраняет данные о направлении подтверждения в базе.

---

### UC-002B-CUS: Уведомление мастера и менеджера  
**Тип связи:** Extend (расширение)

**Описание:** Система отправляет уведомление менеджеру и мастеру о новой записи.

1. Система создает запись и изменяет статус слота на «занят».  
2. Система отправляет менеджеру уведомление о новой записи по настроенному каналу связи.  
3. Система отправляет уведомление мастеру о новой записи по настроенному каналу связи.

---

### UC-002C-CUS: Отправка клиенту уведомлений о предстоящей записи  
**Тип связи:** Extend (расширение)

**Описание:** Система автоматически отправляет клиенту напоминание о записи за 24 часа и за 1 час до её начала.

1. Система формирует уведомление на основе загруженного шаблона.  
2. Система отправляет клиенту напоминание за 24 часа и за 1 час до времени записи.  
3. Система сохраняет данные об отправке уведомления.

## Дополнительно

### Предположения
- В первой версии системы клиент не может подписаться на уведомления о появлении свободных слотов у выбранного мастера. Эта функция может быть реализована в будущих версиях.
- Система автоматически изменяет статус слота на «занят» после успешного бронирования.

## Бизнес-правила
- Время оказания услуги определяется внутренними регламентами и учитывается системой при бронировании (разные услуги требуют разного времени).
- Незарегистрированный пользователь должен дать согласие на обработку персональных данных при предоставлении контактных данных для записи.

## Ограничения
- За одну транзакцию клиент может выбрать только одну услугу.
- Забронировать слот можно не позднее чем за 1 час до его начала.
